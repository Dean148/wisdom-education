<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.education.business.mapper.education.TestPaperInfoMapper">

    <select id="selectPageList" resultType="testPaperInfoDto">
        select paper.*, subject.name subject_name, grade.name gradeInfoName from test_paper_info paper
        left join grade_info grade on paper.grade_info_id = grade.id
        left join subject_info subject on paper.subject_id = subject.id
        <where>
            <if test="testPaperInfo.subjectId != null">
                and paper.subject_id = #{testPaperInfo.subjectId}
            </if>
        </where>
        order by paper.id desc
    </select>


    <!-- 试卷试题列表 -->
    <select id="selectPaperQuestionList" resultType="testPaperQuestionDto">
        select a.id, a.content, b.sort, b.mark, b.test_paper_info_id, a.question_type, a.answer, a.options from question_info a inner join test_paper_question_info b
        on a.id = b.question_info_id inner join test_paper_info c
        on b.test_paper_info_id = c.id where c.id = #{testPaperQuestionRequest.testPaperInfoId}
        <where>
            <if test="testPaperQuestionRequest.questionType != null">
                and question.question_type = #{questionInfo.questionType}
            </if>

            <if test="testPaperQuestionRequest.content != null and testPaperQuestionRequest.content != ''">
                <bind name="content" value="'%' + testPaperQuestionRequest.content + '%'"/>
                and question.content like #{content}
            </if>
        </where>
        order by c.sort asc
    </select>

</mapper>